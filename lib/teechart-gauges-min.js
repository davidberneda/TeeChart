/*
 TeeChart(tm) for JavaScript(tm)
 @fileOverview TeeChart for JavaScript(tm)
 v1.1 - June 2012
 Copyright(c) 2012 by Steema Software SL. All Rights Reserved.
 http://www.steema.com

 Licensed with commercial and non-commercial attributes,
 specifically: http://www.steema.com/licensing/html5

 JavaScript is a trademark of Oracle Corporation.
*/
var Tee=Tee||{};
(function(){Tee.CircularGauge=function(n,k){function G(m,b){m.hover.value!=b&&(m.hover.value=b,m.hover.valid=null!==b,requestAnimFrame(function(){m.chart.draw()}))}Tee.Series.call(this,n,k);this.useAxes=!1;this.min=0;this.max=100;this.step=5;this.value=0;this.angle=280;this.rotation=0;this.rotateText=!1;this.shape="circle";this.drag={enabled:!0};var g=this.bevel=new Tee.Format(this.chart);g.gradient.visible=!0;g.gradient.colors=["white","blue","white"];g.shadow.visible=!1;g.visible=!0;g.stroke.fill=
"";var b=this.center=new Tee.Format(this.chart);b.stroke.fill="";b.gradient.visible=!0;b.size=10;b.visible=!0;b.shadow.visible=!0;b.gradient.offset={x:2,y:-2};b.location={x:0,y:0};b.top=new Tee.Format(this.chart);b.top.size=40;b.top.visible=!0;b.top.stroke.fill="";b.top.gradient.colors=["silver","white"];b.top.gradient.visible=!0;b.top.gradient.direction="topbottom";var u=this.ticks=new Tee.Format(this.chart);u.length=6;u.stroke.fill="silver";u.visible=!0;u.outside=!0;u.triangle=!1;u.fill="white";
var B=this.ticksBack=new Tee.Format(this.chart);B.stroke.fill="";B.fill="black";B.gradient.visible=!0;B.gradient.colors=["red","yellow","green"];B.gradient.direction="rightleft";B.visible=!0;var s=this.minor=new Tee.Format(this.chart);s.stroke.fill="silver";s.visible=!0;s.count=4;var C=this.minorBack=new Tee.Format(this.chart);C.stroke.fill="";C.visible=!0;C.fill="white";C.gradient.visible=!0;C.gradient.direction="bottomtop";C.gradient.colors=["white","gray","white","silver"];var l=this.hand=new Tee.Format(this.chart);
l.size=6;l.length=60;l.back=20;l.gradient.visible=!0;l.gradient.colors[0]="orange";l.shadow.visible=!0;l.shadow.blur=12;l.shadow.color="black";l.stroke.fill="";var H=this.back=new Tee.Format(this.chart);H.fill="black";H.visible=!0;H.gradient.visible=!0;H.gradient.colors=["black","gray"];H.stroke.fill="";var A=this.pointer=new Tee.Format(this.chart);A.size=3;A.fill="black";A.stroke.fill="";A.visible=!0;var v=this.marks,g=v.format;v.location={x:0,y:10};v.visible=!0;g.fill="black";g.font.fill="white";
g.gradient.visible=!0;g.gradient.colors=["gray","black"];g.shadow.visible=!0;g.shadow.blur=8;g.shadow.color="black";var c=this.format;c.visible=!0;c.gradient.visible=!0;c.gradient.colors=["white","black","white"];c.shadow.visible=!0;c.font.style="12px Verdana";c.font.fill="white";c.font.visible=!0;c.size=14;c.round={x:6,y:6};this.units=new Tee.Annotation(this.chart);this.units.transparent=!0;this.units.format.font.fill="orange";this.units.location={x:0,y:24};this.bounds=this.getRect();this.hover.enabled=
!0;var L,w,I,P,t,x,y,z,M,N;this.calcBounds=function(){return this.bounds.custom?this.bounds:this.cellRect(this.bounds,!0)};this.draw=function(){function m(d,f,m,e,b){0<d.radius&&(m=0.01*p*d.radius);a.beginPath();a.arc(0,0,f,e,b,!1);a.arc(0,0,m,b,e,!0);d.draw(a,null,-m,-m,2*m,2*m)}function n(a,d,f){if(a.visible&&""!=a.fill)if(a.ranges&&0<a.ranges.length){var e=k,b,g=a.fill,h=a.gradient.visible,J=j.max-j.min,c=x-t;a.gradient.visible=!1;j.inverted&&(e+=c);for(var i=0;i<a.ranges.length;i++){var l=Math.min(j.max,
a.ranges[i].value);b=0==i?l:l-a.ranges[i-1].value+j.min;b=j.inverted?e-c*(b-j.min)/J:e+c*(b-j.min)/J;a.fill=a.ranges[i].fill;""!==a.fill&&(j.inverted?m(a,d,f,b,e):m(a,d,f,e,b));e=b;if(l>=j.max)break}a.fill=g;a.gradient.visible=h}else m(a,d,f,k,k+(x-t))}function J(d){if(d.visible)if("circle"==j.shape)d.ellipse(y,z,f,h);else if("segment"==j.shape){a.beginPath();var e=j.units.visible?275:240,b=k+0.01745*j.rotation+0.5*(6.283-0.01745*Math.max(e,j.angle)),m=0.5*f,g=0.5*h;a.arc(y,z,m,b,b+Math.max(0.01745*
e,i),!1);a.closePath();d.draw(a,null,y-m,z-g,f,h)}else d.rectangle(y-0.5*f,z-0.5*h,f,h);return d.visible}var i=0.01745*this.angle,d=this.calcBounds(),f,h;y=d.x+0.5*d.width;z=d.y+0.5*d.height;this.bounds.custom?(f=d.width,h=d.height):h=f=Math.min(d.width,d.height);var j=this,a=j.chart.ctx,k=1.57,p=f;for(t=0.01745*j.rotation+0.5*(6.283-i);6.283<=t;)t-=6.283;for(x=t+i;6.283<=x;)x-=6.283;J(c)&&(f*=1-0.01*c.size,h*=1-0.01*c.size,this.bounds.custom||(p=h=f));J(this.bevel)&&(f*=1-0.0020*c.size,h*=1-0.0020*
c.size,this.bounds.custom||(p=h=f));J(H);var q=u.outside,e=this.min,d=this.max-this.min,g=Math.max(0.1,this.step);w=q?0.48*p:0.41*p;L=w-p*0.01*u.length;P=q?0.39*p:this.rotateText?0.46*p:0.48*p;I=q?0.45*p:0.38*p;c.font.prepare();var D=c.textHeight("Wj"),D=Math.max(1,d/g/(p*i/6.283/D)|0);a.fillStyle=c.font.fill;a.save();var E=y,F=z;j.bounds.custom&&(f>h?F+=0.75*h*h/f:E+=0.75*f*f/h);a.translate(E,F);a.rotate(t);n(B,L,w);n(C,I,w);var E=g*i/d/4,F=t,G=this.rotateText?0:0.3*c.textHeight("Wj"),K=0;for(!u.visible&&
q&&(P=0.9*I);e<=this.max;){u.visible&&(q=(this.hover.enabled&&this.hover.valid?Math.abs(e-this.hover.value)<0.2*g?this.hover:null:null)||u,a.beginPath(),a.moveTo(0,L),u.triangle?(a.lineTo(-3,w),a.lineTo(3,w),a.closePath(),q.draw(a,-3,L,3,w)):(a.lineTo(0,w),q.stroke.prepare(),a.stroke()));if(c.font.visible&&0==K%D&&(360!=this.angle||e+g<=this.max)){q=P-0.5*c.textHeight();a.translate(0,q);var O=this.rotateText?3.1416:F;a.rotate(-O);c.font.prepare();a.fillStyle=c.font.fill;var r=j.inverted?this.max-
e:e,r=j.ongetText?j.ongetText(r):(r|0)==r?r.toFixed(0):r.toFixed(this.decimals);a.fillText(r,0,G);a.rotate(O);a.translate(0,-q)}if(s.visible){if(e<this.max)for(q=0;q<s.count;q++){a.rotate(E);r=g/s.count;O=e+(q+1)*r;r=(this.hover.enabled&&this.hover.valid?Math.abs(O-this.hover.value)<0.2*r?this.hover:null:null)||s;if(O>this.max)break;"ellipse"==s.shape?s.ellipse(0,0.5*(I+w),s.size,s.size):(a.beginPath(),a.moveTo(0,I),a.lineTo(0,w),r.stroke.prepare(),a.stroke())}}else a.rotate(E*s.count);F+=E*s.count;
e+=g;K++}a.restore();v.visible&&(v.text=this.value.toFixed(this.decimals),v.resize(),v.position.x=y-0.5*v.bounds.width+0.01*v.location.x*f,v.position.y=z+0.01*v.location.y*h,v.draw());e=this.units;e.visible&&(e.resize(),e.position.x=y-0.5*e.bounds.width+0.01*e.location.x*f,e.position.y=z+0.01*e.location.y*h,e.draw(a));this.value=this.limitValue(this.value);r=this.inverted?this.max-this.value:this.value;d=0.01745*this.rotation+0.5*(9.4248-i)+i*(r-this.min)/d;a.save();M=y+0.0050*f*b.location.x;N=z+
0.0050*h*b.location.y;a.translate(M,N);a.rotate(d);d=l.size;e=0.0050*p*l.back;g=Math.min(d,6);D=0.0050*p*l.length;a.beginPath();1<d?(a.moveTo(-e+g,-d),a.quadraticCurveTo(-e,-d,-e,-d+g),a.lineTo(-e,d-g),a.quadraticCurveTo(-e,d,-e+g,d),a.lineTo(D,0),a.closePath()):(a.moveTo(-e,0),a.lineTo(D,0));1<d?l.draw(a,null,-e,-d,e+D,2*d):(l.stroke.prepare(),a.strokeStyle=l.fill,a.stroke());if(this.ondrawHand)this.ondrawHand(this);A.visible&&A.ellipse(0.5*(I+w),0,A.size,A.size);a.restore();b.visible&&(d=0.01*p*
b.size,b.ellipse(M,N,d,d),b.top.visible&&(d=0.01*d*b.top.size,b.top.ellipse(M,N,d,d)))};this.limitValue=function(b){return Math.min(this.max,Math.max(this.min,b))};this.setValue=function(b){var b=this.limitValue(b),g=this.value!=b;if(g&&(this.value=b,this.onchange))this.onchange(this);return g};this.onclick=function(){};this.clicked=function(){this.dragging=!1;return-1};this.inValue=function(b,g){if(!g.contains(b))return!1;for(var c=b.x-M,i=b.y-N,d=Math.sqrt(c*c+i*i),c=Math.atan2(i,c)-0.5*Math.PI;0>
c;)c+=6.283;var f,h;t>x?(i=x,f=t,h=c>=f||c<=i):(f=x,i=t,h=c>=i&&c<=f);return h?(c=this.min+(this.max-this.min)*(t>x?c>f?(c-f)/(6.283-f+i):(6.283-f+c)/(6.283-f+i):(c-i)/(f-i)),this.inverted&&(c=this.max-c),b.value=c,b.inTicks=d>=Math.min(L,P)&&d<=w,!0):b.inTicks=!1};this.mousemove=function(b){var c=this.calcBounds(),c=this.inValue(b,c);this.dragging?(c&&this.setValue(b.value)&&this.chart.draw(),this.chart.newCursor="pointer"):b.inTicks&&this.drag.enabled?(G(this,b.value),this.chart.newCursor="pointer"):
G(this,null)};var K={x:0,y:0};this.mousedown=function(b){if(this.drag.enabled){var c=this.calcBounds();this.chart.calcMouse(b,K);this.inValue(K,c)?(this.dragging=!0,this.hover.value=null,this.hover.valid=!1,this.setValue(K.value)&&this.chart.draw()):this.dragging=!1;return this.dragging}return!1}};Tee.CircularGauge.prototype=new Tee.Series;Tee.CircularGauge.prototype.setChart=function(n,k){var G=Tee.Series.prototype.setChart;G(n,k);n.back.setChart(k);n.center.setChart(k);n.center.top.setChart(k);
n.ticks.setChart(k);n.ticksBack.setChart(k);n.minor.setChart(k);n.minorBack.setChart(k);n.hand.setChart(k);n.units.format.setChart(k);n.pointer.setChart(k);n.bevel.setChart(k)}})();
